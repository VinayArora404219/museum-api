"""
    main module to get data from museum API and converting the data into various formats.
"""
import logging
import os
import sys
import requests

from museum_api.museumapi import MuseumAPI
from museum_api.utils import Converter, flatten, setup_logger

# setting base directory as current directory.
BASE_DIR = os.path.abspath(os.path.dirname(__file__))

# setting up logger for logging errors.
error_logger = setup_logger('main', 'logs/main_error.log', level=logging.ERROR)

if __name__ == '__main__':
    m = MuseumAPI()

    object_list = None
    for i in range(3):
        try:
            # getting all the objects ids from the museum api.
            # object_ids = m.get_all_object_ids()['objectIDs'][0: 15]
            object_ids = list(range(1, 16))

            keys = ('constituents', 'measurements', 'tags')
            # getting list of detail of each object corresponding to their object ids.
            # object_list = list(
            #     map(lambda object_id: flatten(m.get_object_for_id(object_id), keys), object_ids)
            # )
            object_list = [{'objectID': 1, 'isHighlight': False, 'accessionNumber': '1979.486.1', 'accessionYear': '1979', 'isPublicDomain': False, 'primaryImage': '', 'primaryImageSmall': '', 'additionalImages': [], 'department': 'The American Wing', 'objectName': 'Coin', 'title': 'One-dollar Liberty Head Coin', 'culture': '', 'period': '', 'dynasty': '', 'reign': '', 'portfolio': '', 'artistRole': 'Maker', 'artistPrefix': '', 'artistDisplayName': 'James Barton Longacre', 'artistDisplayBio': 'American, Delaware County, Pennsylvania 1794–1869 Philadelphia, Pennsylvania', 'artistSuffix': '', 'artistAlphaSort': 'Longacre, James Barton', 'artistNationality': 'American', 'artistBeginDate': '1794', 'artistEndDate': '1869', 'artistGender': '', 'artistWikidata_URL': 'https://www.wikidata.org/wiki/Q3806459', 'artistULAN_URL': 'http://vocab.getty.edu/page/ulan/500011409', 'objectDate': '1853', 'objectBeginDate': 1853, 'objectEndDate': 1853, 'medium': 'Gold', 'dimensions': 'Dimensions unavailable', 'measurements': None, 'creditLine': 'Gift of Heinz L. Stoppelmann, 1979', 'geographyType': '', 'city': '', 'state': '', 'county': '', 'country': '', 'region': '', 'subregion': '', 'locale': '', 'locus': '', 'excavation': '', 'river': '', 'classification': '', 'rightsAndReproduction': '', 'linkResource': '', 'metadataDate': '2021-04-06T04:41:04.967Z', 'repository': 'Metropolitan Museum of Art, New York, NY', 'objectURL': 'https://www.metmuseum.org/art/collection/search/1', 'tags': None, 'objectWikidata_URL': '', 'isTimelineWork': False, 'GalleryNumber': '', 'constituentID': 164292, 'role': 'Maker', 'name': 'James Barton Longacre', 'constituentULAN_URL': 'http://vocab.getty.edu/page/ulan/500011409', 'constituentWikidata_URL': 'https://www.wikidata.org/wiki/Q3806459', 'gender': ''}, {'objectID': 2, 'isHighlight': False, 'accessionNumber': '1980.264.5', 'accessionYear': '1980', 'isPublicDomain': False, 'primaryImage': '', 'primaryImageSmall': '', 'additionalImages': [], 'department': 'The American Wing', 'objectName': 'Coin', 'title': 'Ten-dollar Liberty Head Coin', 'culture': '', 'period': '', 'dynasty': '', 'reign': '', 'portfolio': '', 'artistRole': 'Maker', 'artistPrefix': '', 'artistDisplayName': 'Christian Gobrecht', 'artistDisplayBio': '1785–1844', 'artistSuffix': '', 'artistAlphaSort': 'Gobrecht, Christian', 'artistNationality': '', 'artistBeginDate': '1785', 'artistEndDate': '1844', 'artistGender': '', 'artistWikidata_URL': 'https://www.wikidata.org/wiki/Q5109648', 'artistULAN_URL': 'http://vocab.getty.edu/page/ulan/500077295', 'objectDate': '1901', 'objectBeginDate': 1901, 'objectEndDate': 1901, 'medium': 'Gold', 'dimensions': 'Dimensions unavailable', 'measurements': None, 'creditLine': 'Gift of Heinz L. Stoppelmann, 1980', 'geographyType': '', 'city': '', 'state': '', 'county': '', 'country': '', 'region': '', 'subregion': '', 'locale': '', 'locus': '', 'excavation': '', 'river': '', 'classification': '', 'rightsAndReproduction': '', 'linkResource': '', 'metadataDate': '2021-04-06T04:41:04.967Z', 'repository': 'Metropolitan Museum of Art, New York, NY', 'objectURL': 'https://www.metmuseum.org/art/collection/search/2', 'tags': None, 'objectWikidata_URL': '', 'isTimelineWork': False, 'GalleryNumber': '', 'constituentID': 1079, 'role': 'Maker', 'name': 'Christian Gobrecht', 'constituentULAN_URL': 'http://vocab.getty.edu/page/ulan/500077295', 'constituentWikidata_URL': 'https://www.wikidata.org/wiki/Q5109648', 'gender': ''}, {'objectID': 3, 'isHighlight': False, 'accessionNumber': '67.265.9', 'accessionYear': '1967', 'isPublicDomain': False, 'primaryImage': '', 'primaryImageSmall': '', 'additionalImages': [], 'constituents': None, 'department': 'The American Wing', 'objectName': 'Coin', 'title': 'Two-and-a-Half Dollar Coin', 'culture': '', 'period': '', 'dynasty': '', 'reign': '', 'portfolio': '', 'artistRole': '', 'artistPrefix': '', 'artistDisplayName': '', 'artistDisplayBio': '', 'artistSuffix': '', 'artistAlphaSort': '', 'artistNationality': '', 'artistBeginDate': '', 'artistEndDate': '', 'artistGender': '', 'artistWikidata_URL': '', 'artistULAN_URL': '', 'objectDate': '1909–27', 'objectBeginDate': 1909, 'objectEndDate': 1927, 'medium': 'Gold', 'dimensions': 'Diam. 11/16 in. (1.7 cm)', 'creditLine': 'Gift of C. Ruxton Love Jr., 1967', 'geographyType': '', 'city': '', 'state': '', 'county': '', 'country': '', 'region': '', 'subregion': '', 'locale': '', 'locus': '', 'excavation': '', 'river': '', 'classification': '', 'rightsAndReproduction': '', 'linkResource': '', 'metadataDate': '2021-04-06T04:41:04.967Z', 'repository': 'Metropolitan Museum of Art, New York, NY', 'objectURL': 'https://www.metmuseum.org/art/collection/search/3', 'tags': None, 'objectWikidata_URL': '', 'isTimelineWork': False, 'GalleryNumber': '', 'elementName': 'Other', 'elementDescription': 'Object diameter', 'elementMeasurements': {'Diameter': 1.7463}}, {'objectID': 4, 'isHighlight': False, 'accessionNumber': '67.265.10', 'accessionYear': '1967', 'isPublicDomain': False, 'primaryImage': '', 'primaryImageSmall': '', 'additionalImages': [], 'constituents': None, 'department': 'The American Wing', 'objectName': 'Coin', 'title': 'Two-and-a-Half Dollar Coin', 'culture': '', 'period': '', 'dynasty': '', 'reign': '', 'portfolio': '', 'artistRole': '', 'artistPrefix': '', 'artistDisplayName': '', 'artistDisplayBio': '', 'artistSuffix': '', 'artistAlphaSort': '', 'artistNationality': '', 'artistBeginDate': '', 'artistEndDate': '', 'artistGender': '', 'artistWikidata_URL': '', 'artistULAN_URL': '', 'objectDate': '1909–27', 'objectBeginDate': 1909, 'objectEndDate': 1927, 'medium': 'Gold', 'dimensions': 'Diam. 11/16 in. (1.7 cm)', 'creditLine': 'Gift of C. Ruxton Love Jr., 1967', 'geographyType': '', 'city': '', 'state': '', 'county': '', 'country': '', 'region': '', 'subregion': '', 'locale': '', 'locus': '', 'excavation': '', 'river': '', 'classification': '', 'rightsAndReproduction': '', 'linkResource': '', 'metadataDate': '2021-04-06T04:41:04.967Z', 'repository': 'Metropolitan Museum of Art, New York, NY', 'objectURL': 'https://www.metmuseum.org/art/collection/search/4', 'tags': None, 'objectWikidata_URL': '', 'isTimelineWork': False, 'GalleryNumber': '', 'elementName': 'Other', 'elementDescription': 'Object diameter', 'elementMeasurements': {'Diameter': 1.7463}}, {'objectID': 5, 'isHighlight': False, 'accessionNumber': '67.265.11', 'accessionYear': '1967', 'isPublicDomain': False, 'primaryImage': '', 'primaryImageSmall': '', 'additionalImages': [], 'constituents': None, 'department': 'The American Wing', 'objectName': 'Coin', 'title': 'Two-and-a-Half Dollar Coin', 'culture': '', 'period': '', 'dynasty': '', 'reign': '', 'portfolio': '', 'artistRole': '', 'artistPrefix': '', 'artistDisplayName': '', 'artistDisplayBio': '', 'artistSuffix': '', 'artistAlphaSort': '', 'artistNationality': '', 'artistBeginDate': '', 'artistEndDate': '', 'artistGender': '', 'artistWikidata_URL': '', 'artistULAN_URL': '', 'objectDate': '1909–27', 'objectBeginDate': 1909, 'objectEndDate': 1927, 'medium': 'Gold', 'dimensions': 'Diam. 11/16 in. (1.7 cm)', 'creditLine': 'Gift of C. Ruxton Love Jr., 1967', 'geographyType': '', 'city': '', 'state': '', 'county': '', 'country': '', 'region': '', 'subregion': '', 'locale': '', 'locus': '', 'excavation': '', 'river': '', 'classification': '', 'rightsAndReproduction': '', 'linkResource': '', 'metadataDate': '2021-04-06T04:41:04.967Z', 'repository': 'Metropolitan Museum of Art, New York, NY', 'objectURL': 'https://www.metmuseum.org/art/collection/search/5', 'tags': None, 'objectWikidata_URL': '', 'isTimelineWork': False, 'GalleryNumber': '', 'elementName': 'Other', 'elementDescription': 'Object diameter', 'elementMeasurements': {'Diameter': 1.7463}}, {'objectID': 6, 'isHighlight': False, 'accessionNumber': '67.265.12', 'accessionYear': '1967', 'isPublicDomain': False, 'primaryImage': '', 'primaryImageSmall': '', 'additionalImages': [], 'constituents': None, 'department': 'The American Wing', 'objectName': 'Coin', 'title': 'Two-and-a-Half Dollar Coin', 'culture': '', 'period': '', 'dynasty': '', 'reign': '', 'portfolio': '', 'artistRole': '', 'artistPrefix': '', 'artistDisplayName': '', 'artistDisplayBio': '', 'artistSuffix': '', 'artistAlphaSort': '', 'artistNationality': '', 'artistBeginDate': '', 'artistEndDate': '', 'artistGender': '', 'artistWikidata_URL': '', 'artistULAN_URL': '', 'objectDate': '1909–27', 'objectBeginDate': 1909, 'objectEndDate': 1927, 'medium': 'Gold', 'dimensions': 'Diam. 11/16 in. (1.7 cm)', 'creditLine': 'Gift of C. Ruxton Love Jr., 1967', 'geographyType': '', 'city': '', 'state': '', 'county': '', 'country': '', 'region': '', 'subregion': '', 'locale': '', 'locus': '', 'excavation': '', 'river': '', 'classification': '', 'rightsAndReproduction': '', 'linkResource': '', 'metadataDate': '2021-04-06T04:41:04.967Z', 'repository': 'Metropolitan Museum of Art, New York, NY', 'objectURL': 'https://www.metmuseum.org/art/collection/search/6', 'tags': None, 'objectWikidata_URL': '', 'isTimelineWork': False, 'GalleryNumber': '', 'elementName': 'Other', 'elementDescription': 'Object diameter', 'elementMeasurements': {'Diameter': 1.7463}}, {'objectID': 7, 'isHighlight': False, 'accessionNumber': '67.265.13', 'accessionYear': '1967', 'isPublicDomain': False, 'primaryImage': '', 'primaryImageSmall': '', 'additionalImages': [], 'constituents': None, 'department': 'The American Wing', 'objectName': 'Coin', 'title': 'Two-and-a-Half Dollar Coin', 'culture': '', 'period': '', 'dynasty': '', 'reign': '', 'portfolio': '', 'artistRole': '', 'artistPrefix': '', 'artistDisplayName': '', 'artistDisplayBio': '', 'artistSuffix': '', 'artistAlphaSort': '', 'artistNationality': '', 'artistBeginDate': '', 'artistEndDate': '', 'artistGender': '', 'artistWikidata_URL': '', 'artistULAN_URL': '', 'objectDate': '1909–27', 'objectBeginDate': 1909, 'objectEndDate': 1927, 'medium': 'Gold', 'dimensions': 'Diam. 11/16 in. (1.7 cm)', 'creditLine': 'Gift of C. Ruxton Love Jr., 1967', 'geographyType': '', 'city': '', 'state': '', 'county': '', 'country': '', 'region': '', 'subregion': '', 'locale': '', 'locus': '', 'excavation': '', 'river': '', 'classification': '', 'rightsAndReproduction': '', 'linkResource': '', 'metadataDate': '2021-04-06T04:41:04.967Z', 'repository': 'Metropolitan Museum of Art, New York, NY', 'objectURL': 'https://www.metmuseum.org/art/collection/search/7', 'objectWikidata_URL': '', 'isTimelineWork': False, 'GalleryNumber': '', 'elementName': 'Other', 'elementDescription': 'Object diameter', 'elementMeasurements': {'Diameter': 1.7463}, 'term': 'Coins', 'AAT_URL': 'http://vocab.getty.edu/page/aat/300037222', 'Wikidata_URL': 'https://www.wikidata.org/wiki/Q41207'}, {'objectID': 8, 'isHighlight': False, 'accessionNumber': '67.265.14', 'accessionYear': '1967', 'isPublicDomain': False, 'primaryImage': '', 'primaryImageSmall': '', 'additionalImages': [], 'constituents': None, 'department': 'The American Wing', 'objectName': 'Coin', 'title': 'Two-and-a-Half Dollar Coin', 'culture': '', 'period': '', 'dynasty': '', 'reign': '', 'portfolio': '', 'artistRole': '', 'artistPrefix': '', 'artistDisplayName': '', 'artistDisplayBio': '', 'artistSuffix': '', 'artistAlphaSort': '', 'artistNationality': '', 'artistBeginDate': '', 'artistEndDate': '', 'artistGender': '', 'artistWikidata_URL': '', 'artistULAN_URL': '', 'objectDate': '1909–27', 'objectBeginDate': 1909, 'objectEndDate': 1927, 'medium': 'Gold', 'dimensions': 'Diam. 11/16 in. (1.7 cm)', 'creditLine': 'Gift of C. Ruxton Love Jr., 1967', 'geographyType': '', 'city': '', 'state': '', 'county': '', 'country': '', 'region': '', 'subregion': '', 'locale': '', 'locus': '', 'excavation': '', 'river': '', 'classification': '', 'rightsAndReproduction': '', 'linkResource': '', 'metadataDate': '2021-04-06T04:41:04.967Z', 'repository': 'Metropolitan Museum of Art, New York, NY', 'objectURL': 'https://www.metmuseum.org/art/collection/search/8', 'objectWikidata_URL': '', 'isTimelineWork': False, 'GalleryNumber': '', 'elementName': 'Other', 'elementDescription': 'Object diameter', 'elementMeasurements': {'Diameter': 1.7463}, 'term': 'Eagles', 'AAT_URL': 'http://vocab.getty.edu/page/aat/300250049', 'Wikidata_URL': 'https://www.wikidata.org/wiki/Q2092297'}, {'objectID': 9, 'isHighlight': False, 'accessionNumber': '67.265.15', 'accessionYear': '1967', 'isPublicDomain': False, 'primaryImage': '', 'primaryImageSmall': '', 'additionalImages': [], 'constituents': None, 'department': 'The American Wing', 'objectName': 'Coin', 'title': 'Two-and-a-Half Dollar Coin', 'culture': '', 'period': '', 'dynasty': '', 'reign': '', 'portfolio': '', 'artistRole': '', 'artistPrefix': '', 'artistDisplayName': '', 'artistDisplayBio': '', 'artistSuffix': '', 'artistAlphaSort': '', 'artistNationality': '', 'artistBeginDate': '', 'artistEndDate': '', 'artistGender': '', 'artistWikidata_URL': '', 'artistULAN_URL': '', 'objectDate': '1909–27', 'objectBeginDate': 1909, 'objectEndDate': 1927, 'medium': 'Gold', 'dimensions': 'Diam. 11/16 in. (1.7 cm)', 'creditLine': 'Gift of C. Ruxton Love Jr., 1967', 'geographyType': '', 'city': '', 'state': '', 'county': '', 'country': '', 'region': '', 'subregion': '', 'locale': '', 'locus': '', 'excavation': '', 'river': '', 'classification': '', 'rightsAndReproduction': '', 'linkResource': '', 'metadataDate': '2021-04-06T04:41:04.967Z', 'repository': 'Metropolitan Museum of Art, New York, NY', 'objectURL': 'https://www.metmuseum.org/art/collection/search/9', 'tags': None, 'objectWikidata_URL': '', 'isTimelineWork': False, 'GalleryNumber': '', 'elementName': 'Other', 'elementDescription': 'Object diameter', 'elementMeasurements': {'Diameter': 1.7463}}, {'objectID': 10, 'isHighlight': False, 'accessionNumber': '1979.486.3', 'accessionYear': '1979', 'isPublicDomain': False, 'primaryImage': '', 'primaryImageSmall': '', 'additionalImages': [], 'department': 'The American Wing', 'objectName': 'Coin', 'title': 'Two-and-a-half-dollar Indian Head Coin', 'culture': '', 'period': '', 'dynasty': '', 'reign': '', 'portfolio': '', 'artistRole': 'Maker', 'artistPrefix': '', 'artistDisplayName': 'Bela Lyon Pratt', 'artistDisplayBio': '1867–1917', 'artistSuffix': '', 'artistAlphaSort': 'Pratt, Bela Lyon', 'artistNationality': '', 'artistBeginDate': '1867', 'artistEndDate': '1917', 'artistGender': '', 'artistWikidata_URL': 'https://www.wikidata.org/wiki/Q4881787', 'artistULAN_URL': 'http://vocab.getty.edu/page/ulan/500095555', 'objectDate': '1912', 'objectBeginDate': 1912, 'objectEndDate': 1912, 'medium': 'Gold', 'dimensions': 'Dimensions unavailable', 'creditLine': 'Gift of Heinz L. Stoppelmann, 1979', 'geographyType': '', 'city': '', 'state': '', 'county': '', 'country': '', 'region': '', 'subregion': '', 'locale': '', 'locus': '', 'excavation': '', 'river': '', 'classification': '', 'rightsAndReproduction': '', 'linkResource': '', 'metadataDate': '2021-04-06T04:41:04.967Z', 'repository': 'Metropolitan Museum of Art, New York, NY', 'objectURL': 'https://www.metmuseum.org/art/collection/search/10', 'tags': None, 'objectWikidata_URL': '', 'isTimelineWork': False, 'GalleryNumber': '', 'constituentID': 1080, 'role': 'Maker', 'name': 'Bela Lyon Pratt', 'constituentULAN_URL': 'http://vocab.getty.edu/page/ulan/500095555', 'constituentWikidata_URL': 'https://www.wikidata.org/wiki/Q4881787', 'gender': '', 'elementName': 'Other', 'elementDescription': 'Object diameter', 'elementMeasurements': {'Diameter': 1.7}}, {'objectID': 11, 'isHighlight': False, 'accessionNumber': '1979.486.2', 'accessionYear': '1979', 'isPublicDomain': False, 'primaryImage': '', 'primaryImageSmall': '', 'additionalImages': [], 'department': 'The American Wing', 'objectName': 'Coin', 'title': 'Two-and-a-half-dollar Liberty Head Coin', 'culture': '', 'period': '', 'dynasty': '', 'reign': '', 'portfolio': '', 'artistRole': 'Maker', 'artistPrefix': '', 'artistDisplayName': 'Christian Gobrecht', 'artistDisplayBio': '1785–1844', 'artistSuffix': '', 'artistAlphaSort': 'Gobrecht, Christian', 'artistNationality': '', 'artistBeginDate': '1785', 'artistEndDate': '1844', 'artistGender': '', 'artistWikidata_URL': 'https://www.wikidata.org/wiki/Q5109648', 'artistULAN_URL': 'http://vocab.getty.edu/page/ulan/500077295', 'objectDate': '1907', 'objectBeginDate': 1907, 'objectEndDate': 1907, 'medium': 'Gold', 'dimensions': 'Dimensions unavailable', 'creditLine': 'Gift of Heinz L. Stoppelmann, 1979', 'geographyType': '', 'city': '', 'state': '', 'county': '', 'country': '', 'region': '', 'subregion': '', 'locale': '', 'locus': '', 'excavation': '', 'river': '', 'classification': '', 'rightsAndReproduction': '', 'linkResource': '', 'metadataDate': '2021-04-06T04:41:04.967Z', 'repository': 'Metropolitan Museum of Art, New York, NY', 'objectURL': 'https://www.metmuseum.org/art/collection/search/11', 'tags': None, 'objectWikidata_URL': '', 'isTimelineWork': False, 'GalleryNumber': '', 'constituentID': 1079, 'role': 'Maker', 'name': 'Christian Gobrecht', 'constituentULAN_URL': 'http://vocab.getty.edu/page/ulan/500077295', 'constituentWikidata_URL': 'https://www.wikidata.org/wiki/Q5109648', 'gender': '', 'elementName': 'Other', 'elementDescription': 'Object diameter', 'elementMeasurements': {'Diameter': 1.7}}, {'objectID': 12, 'isHighlight': False, 'accessionNumber': '1979.486.7', 'accessionYear': '1979', 'isPublicDomain': False, 'primaryImage': '', 'primaryImageSmall': '', 'additionalImages': [], 'department': 'The American Wing', 'objectName': 'Coin', 'title': 'Twenty-dollar Liberty Head Coin', 'culture': '', 'period': '', 'dynasty': '', 'reign': '', 'portfolio': '', 'artistRole': 'Maker', 'artistPrefix': '', 'artistDisplayName': 'James Barton Longacre', 'artistDisplayBio': 'American, Delaware County, Pennsylvania 1794–1869 Philadelphia, Pennsylvania', 'artistSuffix': '', 'artistAlphaSort': 'Longacre, James Barton', 'artistNationality': 'American', 'artistBeginDate': '1794', 'artistEndDate': '1869', 'artistGender': '', 'artistWikidata_URL': 'https://www.wikidata.org/wiki/Q3806459', 'artistULAN_URL': 'http://vocab.getty.edu/page/ulan/500011409', 'objectDate': '1876', 'objectBeginDate': 1876, 'objectEndDate': 1876, 'medium': 'Gold', 'dimensions': 'Dimensions unavailable', 'creditLine': 'Gift of Heinz L. Stoppelmann, 1979', 'geographyType': '', 'city': '', 'state': '', 'county': '', 'country': '', 'region': '', 'subregion': '', 'locale': '', 'locus': '', 'excavation': '', 'river': '', 'classification': '', 'rightsAndReproduction': '', 'linkResource': '', 'metadataDate': '2021-04-06T04:41:04.967Z', 'repository': 'Metropolitan Museum of Art, New York, NY', 'objectURL': 'https://www.metmuseum.org/art/collection/search/12', 'tags': None, 'objectWikidata_URL': '', 'isTimelineWork': False, 'GalleryNumber': '', 'constituentID': 164292, 'role': 'Maker', 'name': 'James Barton Longacre', 'constituentULAN_URL': 'http://vocab.getty.edu/page/ulan/500011409', 'constituentWikidata_URL': 'https://www.wikidata.org/wiki/Q3806459', 'gender': '', 'elementName': 'Other', 'elementDescription': 'Object diameter', 'elementMeasurements': {'Diameter': 1.7}}, {'objectID': 13, 'isHighlight': False, 'accessionNumber': '1979.486.4', 'accessionYear': '1979', 'isPublicDomain': False, 'primaryImage': '', 'primaryImageSmall': '', 'additionalImages': [], 'department': 'The American Wing', 'objectName': 'Coin', 'title': 'Five-dollar Indian Head Coin', 'culture': '', 'period': '', 'dynasty': '', 'reign': '', 'portfolio': '', 'artistRole': 'Maker', 'artistPrefix': '', 'artistDisplayName': 'Bela Lyon Pratt', 'artistDisplayBio': '1867–1917', 'artistSuffix': '', 'artistAlphaSort': 'Pratt, Bela Lyon', 'artistNationality': '', 'artistBeginDate': '1867', 'artistEndDate': '1917', 'artistGender': '', 'artistWikidata_URL': 'https://www.wikidata.org/wiki/Q4881787', 'artistULAN_URL': 'http://vocab.getty.edu/page/ulan/500095555', 'objectDate': '1910', 'objectBeginDate': 1910, 'objectEndDate': 1910, 'medium': 'Gold', 'dimensions': 'Dimensions unavailable', 'creditLine': 'Gift of Heinz L. Stoppelmann, 1979', 'geographyType': '', 'city': '', 'state': '', 'county': '', 'country': '', 'region': '', 'subregion': '', 'locale': '', 'locus': '', 'excavation': '', 'river': '', 'classification': '', 'rightsAndReproduction': '', 'linkResource': '', 'metadataDate': '2021-04-06T04:41:04.967Z', 'repository': 'Metropolitan Museum of Art, New York, NY', 'objectURL': 'https://www.metmuseum.org/art/collection/search/13', 'tags': None, 'objectWikidata_URL': '', 'isTimelineWork': False, 'GalleryNumber': '', 'constituentID': 1080, 'role': 'Maker', 'name': 'Bela Lyon Pratt', 'constituentULAN_URL': 'http://vocab.getty.edu/page/ulan/500095555', 'constituentWikidata_URL': 'https://www.wikidata.org/wiki/Q4881787', 'gender': '', 'elementName': 'Other', 'elementDescription': 'Object diameter', 'elementMeasurements': {'Diameter': 1.7}}, {'objectID': 14, 'isHighlight': False, 'accessionNumber': '1979.486.5', 'accessionYear': '1979', 'isPublicDomain': False, 'primaryImage': '', 'primaryImageSmall': '', 'additionalImages': [], 'department': 'The American Wing', 'objectName': 'Coin', 'title': 'Five-dollar Liberty Head Coin', 'culture': '', 'period': '', 'dynasty': '', 'reign': '', 'portfolio': '', 'artistRole': 'Maker', 'artistPrefix': '', 'artistDisplayName': 'Christian Gobrecht', 'artistDisplayBio': '1785–1844', 'artistSuffix': '', 'artistAlphaSort': 'Gobrecht, Christian', 'artistNationality': '', 'artistBeginDate': '1785', 'artistEndDate': '1844', 'artistGender': '', 'artistWikidata_URL': 'https://www.wikidata.org/wiki/Q5109648', 'artistULAN_URL': 'http://vocab.getty.edu/page/ulan/500077295', 'objectDate': '1907', 'objectBeginDate': 1907, 'objectEndDate': 1907, 'medium': 'Gold', 'dimensions': 'Dimensions unavailable', 'creditLine': 'Gift of Heinz L. Stoppelmann, 1979', 'geographyType': '', 'city': '', 'state': '', 'county': '', 'country': '', 'region': '', 'subregion': '', 'locale': '', 'locus': '', 'excavation': '', 'river': '', 'classification': '', 'rightsAndReproduction': '', 'linkResource': '', 'metadataDate': '2021-04-06T04:41:04.967Z', 'repository': 'Metropolitan Museum of Art, New York, NY', 'objectURL': 'https://www.metmuseum.org/art/collection/search/14', 'tags': None, 'objectWikidata_URL': '', 'isTimelineWork': False, 'GalleryNumber': '', 'constituentID': 1079, 'role': 'Maker', 'name': 'Christian Gobrecht', 'constituentULAN_URL': 'http://vocab.getty.edu/page/ulan/500077295', 'constituentWikidata_URL': 'https://www.wikidata.org/wiki/Q5109648', 'gender': '', 'elementName': 'Other', 'elementDescription': 'Object diameter', 'elementMeasurements': {'Diameter': 1.7}}, {'objectID': 15, 'isHighlight': False, 'accessionNumber': '16.74.49', 'accessionYear': '1916', 'isPublicDomain': False, 'primaryImage': '', 'primaryImageSmall': '', 'additionalImages': [], 'constituents': None, 'department': 'The American Wing', 'objectName': 'Coin', 'title': 'Coin, 1/2 Real', 'culture': 'Mexican', 'period': '', 'dynasty': '', 'reign': '', 'portfolio': '', 'artistRole': '', 'artistPrefix': '', 'artistDisplayName': '', 'artistDisplayBio': '', 'artistSuffix': '', 'artistAlphaSort': '', 'artistNationality': '', 'artistBeginDate': '', 'artistEndDate': '', 'artistGender': '', 'artistWikidata_URL': '', 'artistULAN_URL': '', 'objectDate': '1665–1700', 'objectBeginDate': 1665, 'objectEndDate': 1700, 'medium': 'Silver', 'dimensions': 'Diam. 1/2 in. (1.3 cm)', 'creditLine': 'Gift of Mrs. Russell Sage, 1916', 'geographyType': 'Made in', 'city': '', 'state': '', 'county': '', 'country': 'Mexico', 'region': '', 'subregion': '', 'locale': '', 'locus': '', 'excavation': '', 'river': '', 'classification': '', 'rightsAndReproduction': '', 'linkResource': '', 'metadataDate': '2021-04-06T04:41:04.967Z', 'repository': 'Metropolitan Museum of Art, New York, NY', 'objectURL': 'https://www.metmuseum.org/art/collection/search/15', 'tags': None, 'objectWikidata_URL': '', 'isTimelineWork': False, 'GalleryNumber': '', 'elementName': 'Other', 'elementDescription': 'Object diameter', 'elementMeasurements': {'Diameter': 1.27}}]

            break

        except (requests.ConnectionError, requests.ConnectTimeout, requests.Timeout) as connError:
            error_logger.error(f'Connection error, Retrying ({(i + 1)/3})')
            if i == 3:
                error_logger.error(
                    "Maximum retires reached. Either server is not responding,"
                    " or client is not connected to internet"
                )
                sys.exit(1)

        except FileNotFoundError as e:
            error_logger.error(str(e))
            sys.exit(1)

    # directory in which reports will be generated.
    report_dir = os.path.join(BASE_DIR, 'reports/')

    # create reports directory if it doesn't exist.
    if os.path.isdir(report_dir):
        pass
    else:
        os.mkdir('reports')

    try:
        Converter.convert_to_csv(
            object_list,
            os.path.join(report_dir, 'museum_data.csv')
        )
        Converter.convert_to_excel(object_list, os.path.join(report_dir, 'museum_data.xlsx'))
        Converter.convert_to_html(object_list, os.path.join(report_dir, 'museum_data.html'))
        Converter.convert_to_xml(object_list, os.path.join(report_dir, 'museum_data.xml'))
        Converter.convert_to_pdf(object_list, os.path.join(report_dir, 'museum_data.pdf'))

    except FileNotFoundError as e:
        error_logger.error('Error occurred :%s' % ({str(e)}))
        sys.exit(1)
